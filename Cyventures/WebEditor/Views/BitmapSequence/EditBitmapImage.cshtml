@model WebEditor.Models.MetaModel<int, WebEditor.EFModel.Bitmap>
@{
    ViewBag.Title = "Edit Bitmap";
    var pixelImages = new string[]
    {
Url.Content("~/Content/images/White.png"),
Url.Content("~/Content/images/DarkGray.png"),
Url.Content("~/Content/images/LightGray.png"),
Url.Content("~/Content/images/Black.png")
    };
}
<p>@Html.ActionLink("Back to Bitmap Sequence", "Detail", new { id = Model.Payload.BitmapSequenceId })</p>
<p>Bitmap Sequence: @Model.Payload.BitmapSequence.BitmapSequenceName</p>
<p>Bitmap Index: @Model.Payload.BitmapIndex </p>
@for (int y = 0; y < Model.Payload.BitmapHeight; ++y)
{
    for (int x = 0; x < Model.Payload.BitmapWidth; ++x)
    {
        var bitmapPixel = Model.Payload.BitmapPixels.SingleOrDefault(gp => gp.X == x && gp.Y == y);
        <a href="@Url.Action("SetBitmapPixel",new { id= Model.Payload.BitmapId, x=x, y=y, color = Model.Meta})"><img src="@pixelImages[bitmapPixel?.ColorId??0]" /></a>
    }
    <br />
}
<p>Current Color:</p>
@for (int color = 0; color < 4; ++color)
{
    if (color == Model.Meta)
    {
        <span>-></span>
    }
    <a href="@Url.Action("EditBitmapImage",new { id= Model.Payload.BitmapId, color = color})"><img src="@pixelImages[color]" /></a>
    if (color == Model.Meta)
    {
        <span>&lt;-</span>
    }
}
